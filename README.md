# Cars Service Task
Тестовое задание для компании "Эмбедика". 
Небольшой REST API сервис, позволяющий хранить информацию об автомобилях (номер, модель, цвет, год производства) и предоставляющий ее по запросу.

Используемые технологии: Play Framework, Sangria для обработки GraphQl запросов, slick - для работы с базой данных, база данных - postgreSQL 

### API
 - `GET /`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- вывод списка всех автомобилей в базе в формате JSON
 - `GET /stats`&nbsp;&nbsp;&nbsp;- статистика базы данных. Содержит такие поля как количество добавленных машин, дата и время первого и последнего добавления.
 - `GET /logs`&nbsp;&nbsp;&nbsp;- вывод логов сервиса
 - `POST /`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- вывод списка всех автомобилей. В теле можно передать json объект с GraphQl запросом для фильтрации вывода
 - `PUT /`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- добавление автомобиля. В теле должен быть json вида 
```js
  {
    "number": "..." //номер в формате AA000A00
    "brand": "..." //название марки автомобиля
    "color": "..." //цвет в hex формате (#000000)
    "issue_year": 0000 //год производства
  }
```
 - `DELETE /`&nbsp;&nbsp;&nbsp;- удаление автомабиля по его ID. Тело должно состоять из единственного числа или json объекта с полем "id". ID автомобиля можно узнать выполнив
 POST запрос с параметрами искомого автомобиля
   

### Архитектура проекта
Основной класс - `CarsController`. В него ведут все роуты и вызвают у него определенную функцию при определенном запросе. Этот класс отвечает за парсинг получаемых данных. 
Далее он вызвает функции одного из трейтов модели: `CarsService`, `StatisticProvider`, `LogsCollector`. Эти трейты декларируют функционал для взаимодействия с данными, 
сбора статистики и предоставления логов соответственно.

- `CarsService` Отвечает за взаимодействе с данными и выполнения GraphQl запросов. Его реализация содержится в классе `CarsServiceImpl`. 
Он принимает реализацию трейта `CarsRepository` для доступа к базе данных. Его реализация содержится в классе `CarsDAO`.
- `StatisticProvider` Отвечает за предоставление статистики. Ее сбор осуществляется с помощью примесей (mixin) к классу, реализующему `CarsRepository` 
- `LogsCollectr` Осуществляет предоставление логов. Сами логи собираются трейтами `ServiceLogger` и `RepoLogger` которые примешиваются к `CarsService` и `CarsRepository` соответственно

Основными классами, используемыми в качестве репозитория и сервиса, выступают `MainRepository` и `MainService`. К ним примешан необходимый функционал 
логирования и статистики, а доступ к ним предоставляется с помощью инъекции зависимостей. 

В качестве модели используется case class `Car`, который содержит следующе поля: `id: Long`, `number: Number`, `brand: String`, `color: Color`, `issue_year: Year`.
классы `Number` и `Color` являются классами-значениями над типом `String`, а `Year` - над типом `Int`.

